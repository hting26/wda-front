(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cart"],{1876:function(t,e,r){},"6fe5":function(t,e,r){"use strict";r("1876")},a434:function(t,e,r){"use strict";var n=r("23e7"),a=r("da84"),c=r("23cb"),i=r("5926"),s=r("07fa"),o=r("7b0b"),u=r("65f0"),l=r("8418"),p=r("1dde"),d=p("splice"),f=a.TypeError,m=Math.max,h=Math.min,b=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var r,n,a,p,d,k,w=o(this),g=s(w),x=c(t,g),y=arguments.length;if(0===y?r=n=0:1===y?(r=0,n=g-x):(r=y-2,n=h(m(i(e),0),g-x)),g+r-n>b)throw f(v);for(a=u(w,n),p=0;p<n;p++)d=x+p,d in w&&l(a,p,w[d]);if(a.length=n,r<n){for(p=x;p<g-n;p++)d=p+n,k=p+r,d in w?w[k]=w[d]:delete w[k];for(p=g;p>g-n+r;p--)delete w[p-1]}else if(r>n)for(p=g-n;p>x;p--)d=p+n-1,k=p+r-1,d in w?w[k]=w[d]:delete w[k];for(p=0;p<r;p++)w[p+x]=arguments[p+2];return w.length=g-n+r,a}})},b789:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"text-center",attrs:{id:"cart"}},[r("b-container",[r("h3",{staticClass:"pageTitle"},[t._v("物資籃 Donate Cart")]),r("b-table",{staticClass:"mt-5",attrs:{items:t.products,fields:t.fields,"tbody-tr-class":t.rowClass,"show-empty":""},scopedSlots:t._u([{key:"empty",fn:function(){return[r("div",{staticClass:"my-5"},[r("p",[t._v("物資籃目前沒有商品")]),r("a",{attrs:{href:"#/donate"}},[t._v("點我去選購捐贈物資 :)")])])]},proxy:!0},{key:"cell(image)",fn:function(e){return[e.item.product.image?r("img",{staticStyle:{height:"50px"},attrs:{src:e.item.product.image}}):t._e()]}},{key:"cell(name)",fn:function(e){return[t._v(t._s(e.item.product.name))]}},{key:"cell(price)",fn:function(e){return[t._v("NT."+t._s(e.item.product.price))]}},{key:"cell(action)",fn:function(e){return[r("b-form-spinbutton",{attrs:{min:"1",inline:""},on:{input:function(r){return t.updateCart(e.index,e.item.quantity)}},model:{value:e.item.quantity,callback:function(r){t.$set(e.item,"quantity",r)},expression:"data.item.quantity"}}),t._v(" "),r("b-icon",{staticClass:"trashbtn ml-2",attrs:{icon:"trash",variant:"danger"},on:{click:function(r){return t.updateCart(e.index,0)}}})]}}])}),r("p",{staticClass:"text-center"},[t._v("總金額 "+t._s(t.total))]),r("b-btn",{staticClass:"checkbtn",attrs:{size:"lg",variant:"accent",disabled:0===t.products.length},on:{click:t.checkout}},[t._v("結帳")])],1)],1)},a=[],c=r("1da1"),i=(r("96cf"),r("a434"),r("d3b7"),{data:function(){return{products:[],fields:[{key:"image",label:"圖片"},{key:"name",label:"名稱"},{key:"price",label:"價格"},{key:"action",label:"數量"}]}},methods:{updateCart:function(t,e){var r=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.api.patch("/users/me/cart",{product:r.products[t].product._id,quantity:e},{headers:{authorization:"Bearer "+r.user.token}});case 3:0===e&&(r.products.splice(t,1),r.$store.commit("user/updateCart",r.user.cart-1)),n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](0),r.$swal({icon:"error",title:"失敗",text:"修改物資籃失敗"});case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))()},checkout:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.post("/orders",{},{headers:{authorization:"Bearer "+t.user.token}});case 3:t.$swal({icon:"success",title:"成功",text:"結帳成功"}),t.$router.push("/member/orders"),t.$store.commit("user/updateCart",0),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"失敗",text:"結帳失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},rowClass:function(t,e){if(t&&"row"===e)return t.product.sell?"":"bg-danger"}},computed:{total:function(){return this.products.reduce((function(t,e){return t+e.quantity*e.product.price}),0)}},created:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.get("/users/me/cart",{headers:{authorization:"Bearer "+t.user.token}});case 3:r=e.sent,n=r.data,t.products=n.result,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"失敗",text:"取得購物車失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}}),s=i,o=(r("6fe5"),r("2877")),u=Object(o["a"])(s,n,a,!1,null,null,null);e["default"]=u.exports}}]);
//# sourceMappingURL=cart.1d10134b.js.map