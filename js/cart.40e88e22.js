(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cart"],{1876:function(e,t,r){},"6fe5":function(e,t,r){"use strict";r("1876")},a434:function(e,t,r){"use strict";var n=r("23e7"),a=r("da84"),o=r("23cb"),i=r("5926"),c=r("07fa"),s=r("7b0b"),u=r("65f0"),l=r("8418"),p=r("1dde"),d=p("splice"),f=a.TypeError,m=Math.max,h=Math.min,b=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var r,n,a,p,d,x,k=s(this),g=c(k),y=o(e,g),w=arguments.length;if(0===w?r=n=0:1===w?(r=0,n=g-y):(r=w-2,n=h(m(i(t),0),g-y)),g+r-n>b)throw f(v);for(a=u(k,n),p=0;p<n;p++)d=y+p,d in k&&l(a,p,k[d]);if(a.length=n,r<n){for(p=y;p<g-n;p++)d=p+n,x=p+r,d in k?k[x]=k[d]:delete k[x];for(p=g;p>g-n+r;p--)delete k[p-1]}else if(r>n)for(p=g-n;p>y;p--)d=p+n-1,x=p+r-1,d in k?k[x]=k[d]:delete k[x];for(p=0;p<r;p++)k[p+y]=arguments[p+2];return k.length=g-n+r,a}})},b789:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"text-center",attrs:{id:"cart"}},[r("b-container",[r("h3",{staticClass:"pageTitle"},[e._v("物資籃 Donate Cart")]),r("b-table",{staticClass:"mt-5",attrs:{items:e.products,fields:e.fields,"tbody-tr-class":e.rowClass,"show-empty":"",striped:"",borderless:""},scopedSlots:e._u([{key:"empty",fn:function(){return[r("div",{staticClass:"my-5"},[r("p",[e._v("物資籃目前沒有商品")]),r("a",{attrs:{href:"#/donate"}},[e._v("點我去選購捐贈物資 :)")])])]},proxy:!0},{key:"cell(image)",fn:function(t){return[t.item.product.image?r("img",{staticStyle:{height:"50px"},attrs:{src:t.item.product.image}}):e._e()]}},{key:"cell(name)",fn:function(t){return[e._v(e._s(t.item.product.name))]}},{key:"cell(price)",fn:function(t){return[e._v("NT."+e._s(t.item.product.price))]}},{key:"cell(action)",fn:function(t){return[r("b-form-spinbutton",{attrs:{min:"1",inline:""},on:{input:function(r){return e.updateCart(t.index,t.item.quantity)}},model:{value:t.item.quantity,callback:function(r){e.$set(t.item,"quantity",r)},expression:"data.item.quantity"}}),e._v(" "),r("b-icon",{staticClass:"trashbtn ml-2",attrs:{icon:"trash",variant:"danger"},on:{click:function(r){return e.updateCart(t.index,0)}}})]}}])}),r("div",{attrs:{id:"checkOut"}},[r("b-col",{staticClass:"col",attrs:{cols:"12",md:"6"}},[r("h3",{staticClass:"text-center mb-4 text-accent"},[e._v("結帳")]),r("b-form",[r("b-form-group",{attrs:{label:"姓名","label-for":"name"}},[r("b-form-input",{attrs:{id:"name",required:"",placeholder:"請輸入姓名",type:"text"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("b-form-group",{attrs:{label:"電話","label-for":"phone"}},[r("b-form-input",{attrs:{id:"phone",required:"",placeholder:"請輸入電話",type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),r("b-form-group",{attrs:{label:"匯款資料","label-for":"info"}},[r("b-form-input",{attrs:{id:"info",required:"",placeholder:"請輸入匯款資料",type:"text"},model:{value:e.form.info,callback:function(t){e.$set(e.form,"info",t)},expression:"form.info"}})],1)],1)],1)],1),r("h5",{staticClass:"text-center"},[e._v("總金額 "+e._s(e.total))]),r("b-btn",{staticClass:"checkbtn",attrs:{size:"lg",variant:"accent",disabled:0===e.products.length},on:{click:e.checkout}},[e._v("結帳")])],1)],1)},a=[],o=r("1da1"),i=(r("96cf"),r("a434"),r("d3b7"),{data:function(){return{form:{name:"",phone:"",info:""},products:[],fields:[{key:"image",label:"圖片"},{key:"name",label:"名稱"},{key:"price",label:"價格"},{key:"action",label:"數量"}]}},methods:{updateCart:function(e,t){var r=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.api.patch("/users/me/cart",{product:r.products[e].product._id,quantity:t},{headers:{authorization:"Bearer "+r.user.token}});case 3:0===t&&(r.products.splice(e,1),r.$store.commit("user/updateCart",r.user.cart-1)),n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](0),r.$swal({icon:"error",title:"失敗",text:"修改物資籃失敗"});case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))()},checkout:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.api.post("/orders",e.form,{headers:{authorization:"Bearer "+e.user.token}});case 3:e.$swal({icon:"success",title:"成功",text:"結帳成功"}),e.$router.push("/member/orders"),e.$store.commit("user/updateCart",0),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$swal({icon:"error",title:"失敗",text:"結帳失敗"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},rowClass:function(e,t){if(e&&"row"===t)return e.product.sell?"":"bg-danger"}},computed:{total:function(){return this.products.reduce((function(e,t){return e+t.quantity*t.product.price}),0)}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.api.get("/users/me/cart",{headers:{authorization:"Bearer "+e.user.token}});case 3:r=t.sent,n=r.data,e.products=n.result,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$swal({icon:"error",title:"失敗",text:"取得購物車失敗"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}),c=i,s=(r("6fe5"),r("2877")),u=Object(s["a"])(c,n,a,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=cart.40e88e22.js.map